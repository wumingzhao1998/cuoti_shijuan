# GitHub推送问题排查指南

## 快速诊断

运行 `诊断推送问题.bat` 脚本，它会自动检查所有常见问题。

## 常见问题及解决方案

### 问题1：认证失败（Authentication failed）

**错误信息：**
```
remote: Support for password authentication was removed on August 13, 2021.
fatal: Authentication failed
```

**原因：** GitHub已不再支持密码认证，需要使用Personal Access Token或SSH密钥。

**解决方案A：使用Personal Access Token（推荐）**

1. 访问 https://github.com/settings/tokens
2. 点击 "Generate new token" > "Generate new token (classic)"
3. 输入token名称（如：cuoti_shijuan）
4. 勾选 `repo` 权限
5. 点击 "Generate token"
6. **重要：立即复制token**（只显示一次）
7. 推送时：
   - 用户名：输入你的GitHub用户名
   - 密码：输入刚才复制的Personal Access Token

**解决方案B：使用SSH密钥**

1. 生成SSH密钥（如果还没有）：
   ```bash
   ssh-keygen -t ed25519 -C "your_email@example.com"
   ```
   按回车使用默认路径，设置密码（可选）

2. 复制公钥：
   ```bash
   cat ~/.ssh/id_ed25519.pub
   ```
   Windows路径：`C:\Users\你的用户名\.ssh\id_ed25519.pub`

3. 添加到GitHub：
   - 访问 https://github.com/settings/keys
   - 点击 "New SSH key"
   - 粘贴公钥内容
   - 点击 "Add SSH key"

4. 更改远程仓库地址为SSH：
   ```bash
   git remote set-url origin git@github.com:cuoti_shijuan/cuoti_shijuan.git
   ```

5. 测试连接：
   ```bash
   ssh -T git@github.com
   ```

### 问题2：远程仓库不存在

**错误信息：**
```
fatal: repository 'https://github.com/cuoti_shijuan/cuoti_shijuan.git' not found
```

**原因：** GitHub上还没有创建该仓库。

**解决方案：**

1. 访问 https://github.com/new
2. 仓库名称：`cuoti_shijuan`
3. 选择 Public 或 Private
4. **不要**勾选 "Initialize this repository with a README"（本地已有文件）
5. 点击 "Create repository"

### 问题3：分支名称不匹配

**错误信息：**
```
error: src refspec main does not match any
```

**原因：** 本地分支名称与远程不匹配。

**解决方案：**

```bash
# 检查当前分支
git branch

# 如果当前分支不是main，重命名或创建main分支
git branch -M main

# 或者推送到master分支
git push -u origin master
```

### 问题4：没有提交内容

**错误信息：**
```
Everything up-to-date
```

**原因：** 没有新的提交需要推送。

**解决方案：**

```bash
# 检查状态
git status

# 如果有未提交的更改，先提交
git add .
git commit -m "更新说明"

# 然后再推送
git push -u origin main
```

### 问题5：网络连接问题

**错误信息：**
```
fatal: unable to access 'https://github.com/...': Failed to connect to github.com
```

**原因：** 网络无法访问GitHub。

**解决方案：**

1. 检查网络连接
2. 检查防火墙设置
3. 如果在中国大陆，可能需要使用代理或VPN
4. 尝试使用SSH方式（通常更稳定）

## 完整推送流程

### 方式一：使用HTTPS + Personal Access Token

```bash
# 1. 初始化（如果还没有）
git init

# 2. 配置远程仓库
git remote add origin https://github.com/cuoti_shijuan/cuoti_shijuan.git

# 3. 添加文件
git add .

# 4. 提交
git commit -m "发布 v1.0 版本"

# 5. 创建标签
git tag -a v1.0 -m "版本 v1.0"

# 6. 推送到main分支（会提示输入用户名和token）
git push -u origin main

# 7. 推送标签
git push origin v1.0
```

### 方式二：使用SSH

```bash
# 1-5步同上

# 6. 更改远程地址为SSH
git remote set-url origin git@github.com:cuoti_shijuan/cuoti_shijuan.git

# 7. 推送（不需要输入密码）
git push -u origin main
git push origin v1.0
```

## 使用脚本自动修复

### 步骤1：运行诊断脚本

双击运行 `诊断推送问题.bat`，查看具体问题。

### 步骤2：运行修复脚本

双击运行 `修复并推送.bat`，脚本会尝试自动修复并推送。

## 验证推送成功

推送成功后，访问以下地址验证：

- **仓库地址：** https://github.com/cuoti_shijuan/cuoti_shijuan
- **标签地址：** https://github.com/cuoti_shijuan/cuoti_shijuan/releases/tag/v1.0

## 获取帮助

如果以上方法都无法解决问题，请：

1. 运行 `诊断推送问题.bat` 获取详细诊断信息
2. 记录具体的错误信息
3. 检查GitHub账户权限
4. 确认仓库名称和路径正确

## 常用命令参考

```bash
# 查看远程仓库配置
git remote -v

# 查看当前分支
git branch

# 查看提交历史
git log --oneline

# 查看标签
git tag

# 测试远程连接
git ls-remote origin

# 查看Git配置
git config --list
```
